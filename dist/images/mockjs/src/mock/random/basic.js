'use strict';

/*
    ## Basics
*/
module.exports = {
    // 返回一个随机的布尔值。
    boolean: function boolean(min, max, cur) {
        if (cur !== undefined) {
            min = typeof min !== 'undefined' && !isNaN(min) ? parseInt(min, 10) : 1;
            max = typeof max !== 'undefined' && !isNaN(max) ? parseInt(max, 10) : 1;
            return Math.random() > 1.0 / (min + max) * min ? !cur : cur;
        }

        return Math.random() >= 0.5;
    },
    bool: function bool(min, max, cur) {
        return this.boolean(min, max, cur);
    },
    // 返回一个随机的自然数（大于等于 0 的整数）。
    natural: function natural(min, max) {
        min = typeof min !== 'undefined' ? parseInt(min, 10) : 0;
        max = typeof max !== 'undefined' ? parseInt(max, 10) : 9007199254740992; // 2^53
        return Math.round(Math.random() * (max - min)) + min;
    },
    // 返回一个随机的整数。
    integer: function integer(min, max) {
        min = typeof min !== 'undefined' ? parseInt(min, 10) : -9007199254740992;
        max = typeof max !== 'undefined' ? parseInt(max, 10) : 9007199254740992; // 2^53
        return Math.round(Math.random() * (max - min)) + min;
    },
    int: function int(min, max) {
        return this.integer(min, max);
    },
    // 返回一个随机的浮点数。
    float: function float(min, max, dmin, dmax) {
        dmin = dmin === undefined ? 0 : dmin;
        dmin = Math.max(Math.min(dmin, 17), 0);
        dmax = dmax === undefined ? 17 : dmax;
        dmax = Math.max(Math.min(dmax, 17), 0);
        var ret = this.integer(min, max) + '.';
        for (var i = 0, dcount = this.natural(dmin, dmax); i < dcount; i++) {
            ret +=
            // 最后一位不能为 0：如果最后一位为 0，会被 JS 引擎忽略掉。
            i < dcount - 1 ? this.character('number') : this.character('123456789');
        }
        return parseFloat(ret, 10);
    },
    // 返回一个随机字符。
    character: function character(pool) {
        var pools = {
            lower: 'abcdefghijklmnopqrstuvwxyz',
            upper: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
            number: '0123456789',
            symbol: '!@#$%^&*()[]'
        };
        pools.alpha = pools.lower + pools.upper;
        pools['undefined'] = pools.lower + pools.upper + pools.number + pools.symbol;

        pool = pools[('' + pool).toLowerCase()] || pool;
        return pool.charAt(this.natural(0, pool.length - 1));
    },
    char: function char(pool) {
        return this.character(pool);
    },
    // 返回一个随机字符串。
    string: function string(pool, min, max) {
        var len;
        switch (arguments.length) {
            case 0:
                // ()
                len = this.natural(3, 7);
                break;
            case 1:
                // ( length )
                len = pool;
                pool = undefined;
                break;
            case 2:
                // ( pool, length )
                if (typeof arguments[0] === 'string') {
                    len = min;
                } else {
                    // ( min, max )
                    len = this.natural(pool, min);
                    pool = undefined;
                }
                break;
            case 3:
                len = this.natural(min, max);
                break;
        }

        var text = '';
        for (var i = 0; i < len; i++) {
            text += this.character(pool);
        }

        return text;
    },
    str: function str() /*pool, min, max*/{
        return this.string.apply(this, arguments);
    },
    // 返回一个整型数组。
    range: function range(start, stop, step) {
        // range( stop )
        if (arguments.length <= 1) {
            stop = start || 0;
            start = 0;
        }
        // range( start, stop )
        step = arguments[2] || 1;

        start = +start;
        stop = +stop;
        step = +step;

        var len = Math.max(Math.ceil((stop - start) / step), 0);
        var idx = 0;
        var range = new Array(len);

        while (idx < len) {
            range[idx++] = start;
            start += step;
        }

        return range;
    }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhc2ljLmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJib29sZWFuIiwibWluIiwibWF4IiwiY3VyIiwidW5kZWZpbmVkIiwiaXNOYU4iLCJwYXJzZUludCIsIk1hdGgiLCJyYW5kb20iLCJib29sIiwibmF0dXJhbCIsInJvdW5kIiwiaW50ZWdlciIsImludCIsImZsb2F0IiwiZG1pbiIsImRtYXgiLCJyZXQiLCJpIiwiZGNvdW50IiwiY2hhcmFjdGVyIiwicGFyc2VGbG9hdCIsInBvb2wiLCJwb29scyIsImxvd2VyIiwidXBwZXIiLCJudW1iZXIiLCJzeW1ib2wiLCJhbHBoYSIsInRvTG93ZXJDYXNlIiwiY2hhckF0IiwibGVuZ3RoIiwiY2hhciIsInN0cmluZyIsImxlbiIsImFyZ3VtZW50cyIsInRleHQiLCJzdHIiLCJhcHBseSIsInJhbmdlIiwic3RhcnQiLCJzdG9wIiwic3RlcCIsImNlaWwiLCJpZHgiLCJBcnJheSJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7O0FBR0FBLE9BQU9DLE9BQVAsR0FBaUI7QUFDYjtBQUNBQyxhQUFTLGlCQUFTQyxHQUFULEVBQWNDLEdBQWQsRUFBbUJDLEdBQW5CLEVBQXdCO0FBQzdCLFlBQUlBLFFBQVFDLFNBQVosRUFBdUI7QUFDbkJILGtCQUFNLE9BQU9BLEdBQVAsS0FBZSxXQUFmLElBQThCLENBQUNJLE1BQU1KLEdBQU4sQ0FBL0IsR0FBNENLLFNBQVNMLEdBQVQsRUFBYyxFQUFkLENBQTVDLEdBQWdFLENBQXRFO0FBQ0FDLGtCQUFNLE9BQU9BLEdBQVAsS0FBZSxXQUFmLElBQThCLENBQUNHLE1BQU1ILEdBQU4sQ0FBL0IsR0FBNENJLFNBQVNKLEdBQVQsRUFBYyxFQUFkLENBQTVDLEdBQWdFLENBQXRFO0FBQ0EsbUJBQU9LLEtBQUtDLE1BQUwsS0FBZ0IsT0FBT1AsTUFBTUMsR0FBYixJQUFvQkQsR0FBcEMsR0FBMEMsQ0FBQ0UsR0FBM0MsR0FBaURBLEdBQXhEO0FBQ0g7O0FBRUQsZUFBT0ksS0FBS0MsTUFBTCxNQUFpQixHQUF4QjtBQUNILEtBVlk7QUFXYkMsVUFBTSxjQUFTUixHQUFULEVBQWNDLEdBQWQsRUFBbUJDLEdBQW5CLEVBQXdCO0FBQzFCLGVBQU8sS0FBS0gsT0FBTCxDQUFhQyxHQUFiLEVBQWtCQyxHQUFsQixFQUF1QkMsR0FBdkIsQ0FBUDtBQUNILEtBYlk7QUFjYjtBQUNBTyxhQUFTLGlCQUFTVCxHQUFULEVBQWNDLEdBQWQsRUFBbUI7QUFDeEJELGNBQU0sT0FBT0EsR0FBUCxLQUFlLFdBQWYsR0FBNkJLLFNBQVNMLEdBQVQsRUFBYyxFQUFkLENBQTdCLEdBQWlELENBQXZEO0FBQ0FDLGNBQU0sT0FBT0EsR0FBUCxLQUFlLFdBQWYsR0FBNkJJLFNBQVNKLEdBQVQsRUFBYyxFQUFkLENBQTdCLEdBQWlELGdCQUF2RCxDQUZ3QixDQUVnRDtBQUN4RSxlQUFPSyxLQUFLSSxLQUFMLENBQVdKLEtBQUtDLE1BQUwsTUFBaUJOLE1BQU1ELEdBQXZCLENBQVgsSUFBMENBLEdBQWpEO0FBQ0gsS0FuQlk7QUFvQmI7QUFDQVcsYUFBUyxpQkFBU1gsR0FBVCxFQUFjQyxHQUFkLEVBQW1CO0FBQ3hCRCxjQUFNLE9BQU9BLEdBQVAsS0FBZSxXQUFmLEdBQTZCSyxTQUFTTCxHQUFULEVBQWMsRUFBZCxDQUE3QixHQUFpRCxDQUFDLGdCQUF4RDtBQUNBQyxjQUFNLE9BQU9BLEdBQVAsS0FBZSxXQUFmLEdBQTZCSSxTQUFTSixHQUFULEVBQWMsRUFBZCxDQUE3QixHQUFpRCxnQkFBdkQsQ0FGd0IsQ0FFZ0Q7QUFDeEUsZUFBT0ssS0FBS0ksS0FBTCxDQUFXSixLQUFLQyxNQUFMLE1BQWlCTixNQUFNRCxHQUF2QixDQUFYLElBQTBDQSxHQUFqRDtBQUNILEtBekJZO0FBMEJiWSxTQUFLLGFBQVNaLEdBQVQsRUFBY0MsR0FBZCxFQUFtQjtBQUNwQixlQUFPLEtBQUtVLE9BQUwsQ0FBYVgsR0FBYixFQUFrQkMsR0FBbEIsQ0FBUDtBQUNILEtBNUJZO0FBNkJiO0FBQ0FZLFdBQU8sZUFBU2IsR0FBVCxFQUFjQyxHQUFkLEVBQW1CYSxJQUFuQixFQUF5QkMsSUFBekIsRUFBK0I7QUFDbENELGVBQU9BLFNBQVNYLFNBQVQsR0FBcUIsQ0FBckIsR0FBeUJXLElBQWhDO0FBQ0FBLGVBQU9SLEtBQUtMLEdBQUwsQ0FBU0ssS0FBS04sR0FBTCxDQUFTYyxJQUFULEVBQWUsRUFBZixDQUFULEVBQTZCLENBQTdCLENBQVA7QUFDQUMsZUFBT0EsU0FBU1osU0FBVCxHQUFxQixFQUFyQixHQUEwQlksSUFBakM7QUFDQUEsZUFBT1QsS0FBS0wsR0FBTCxDQUFTSyxLQUFLTixHQUFMLENBQVNlLElBQVQsRUFBZSxFQUFmLENBQVQsRUFBNkIsQ0FBN0IsQ0FBUDtBQUNBLFlBQUlDLE1BQU0sS0FBS0wsT0FBTCxDQUFhWCxHQUFiLEVBQWtCQyxHQUFsQixJQUF5QixHQUFuQztBQUNBLGFBQUssSUFBSWdCLElBQUksQ0FBUixFQUFXQyxTQUFTLEtBQUtULE9BQUwsQ0FBYUssSUFBYixFQUFtQkMsSUFBbkIsQ0FBekIsRUFBbURFLElBQUlDLE1BQXZELEVBQStERCxHQUEvRCxFQUFvRTtBQUNoRUQ7QUFDSTtBQUNDQyxnQkFBSUMsU0FBUyxDQUFkLEdBQW1CLEtBQUtDLFNBQUwsQ0FBZSxRQUFmLENBQW5CLEdBQThDLEtBQUtBLFNBQUwsQ0FBZSxXQUFmLENBRmxEO0FBSUg7QUFDRCxlQUFPQyxXQUFXSixHQUFYLEVBQWdCLEVBQWhCLENBQVA7QUFDSCxLQTNDWTtBQTRDYjtBQUNBRyxlQUFXLG1CQUFTRSxJQUFULEVBQWU7QUFDdEIsWUFBSUMsUUFBUTtBQUNSQyxtQkFBTyw0QkFEQztBQUVSQyxtQkFBTyw0QkFGQztBQUdSQyxvQkFBUSxZQUhBO0FBSVJDLG9CQUFRO0FBSkEsU0FBWjtBQU1BSixjQUFNSyxLQUFOLEdBQWNMLE1BQU1DLEtBQU4sR0FBY0QsTUFBTUUsS0FBbEM7QUFDQUYsY0FBTSxXQUFOLElBQXFCQSxNQUFNQyxLQUFOLEdBQWNELE1BQU1FLEtBQXBCLEdBQTRCRixNQUFNRyxNQUFsQyxHQUEyQ0gsTUFBTUksTUFBdEU7O0FBRUFMLGVBQU9DLE1BQU0sQ0FBQyxLQUFLRCxJQUFOLEVBQVlPLFdBQVosRUFBTixLQUFvQ1AsSUFBM0M7QUFDQSxlQUFPQSxLQUFLUSxNQUFMLENBQVksS0FBS3BCLE9BQUwsQ0FBYSxDQUFiLEVBQWdCWSxLQUFLUyxNQUFMLEdBQWMsQ0FBOUIsQ0FBWixDQUFQO0FBQ0gsS0F6RFk7QUEwRGJDLFVBQU0sY0FBU1YsSUFBVCxFQUFlO0FBQ2pCLGVBQU8sS0FBS0YsU0FBTCxDQUFlRSxJQUFmLENBQVA7QUFDSCxLQTVEWTtBQTZEYjtBQUNBVyxZQUFRLGdCQUFTWCxJQUFULEVBQWVyQixHQUFmLEVBQW9CQyxHQUFwQixFQUF5QjtBQUM3QixZQUFJZ0MsR0FBSjtBQUNBLGdCQUFRQyxVQUFVSixNQUFsQjtBQUNJLGlCQUFLLENBQUw7QUFBUTtBQUNKRyxzQkFBTSxLQUFLeEIsT0FBTCxDQUFhLENBQWIsRUFBZ0IsQ0FBaEIsQ0FBTjtBQUNBO0FBQ0osaUJBQUssQ0FBTDtBQUFRO0FBQ0p3QixzQkFBTVosSUFBTjtBQUNBQSx1QkFBT2xCLFNBQVA7QUFDQTtBQUNKLGlCQUFLLENBQUw7QUFDSTtBQUNBLG9CQUFJLE9BQU8rQixVQUFVLENBQVYsQ0FBUCxLQUF3QixRQUE1QixFQUFzQztBQUNsQ0QsMEJBQU1qQyxHQUFOO0FBQ0gsaUJBRkQsTUFFTztBQUNIO0FBQ0FpQywwQkFBTSxLQUFLeEIsT0FBTCxDQUFhWSxJQUFiLEVBQW1CckIsR0FBbkIsQ0FBTjtBQUNBcUIsMkJBQU9sQixTQUFQO0FBQ0g7QUFDRDtBQUNKLGlCQUFLLENBQUw7QUFDSThCLHNCQUFNLEtBQUt4QixPQUFMLENBQWFULEdBQWIsRUFBa0JDLEdBQWxCLENBQU47QUFDQTtBQXBCUjs7QUF1QkEsWUFBSWtDLE9BQU8sRUFBWDtBQUNBLGFBQUssSUFBSWxCLElBQUksQ0FBYixFQUFnQkEsSUFBSWdCLEdBQXBCLEVBQXlCaEIsR0FBekIsRUFBOEI7QUFDMUJrQixvQkFBUSxLQUFLaEIsU0FBTCxDQUFlRSxJQUFmLENBQVI7QUFDSDs7QUFFRCxlQUFPYyxJQUFQO0FBQ0gsS0E3Rlk7QUE4RmJDLFNBQUssZUFBVSxrQkFBcUI7QUFDaEMsZUFBTyxLQUFLSixNQUFMLENBQVlLLEtBQVosQ0FBa0IsSUFBbEIsRUFBd0JILFNBQXhCLENBQVA7QUFDSCxLQWhHWTtBQWlHYjtBQUNBSSxXQUFPLGVBQVNDLEtBQVQsRUFBZ0JDLElBQWhCLEVBQXNCQyxJQUF0QixFQUE0QjtBQUMvQjtBQUNBLFlBQUlQLFVBQVVKLE1BQVYsSUFBb0IsQ0FBeEIsRUFBMkI7QUFDdkJVLG1CQUFPRCxTQUFTLENBQWhCO0FBQ0FBLG9CQUFRLENBQVI7QUFDSDtBQUNEO0FBQ0FFLGVBQU9QLFVBQVUsQ0FBVixLQUFnQixDQUF2Qjs7QUFFQUssZ0JBQVEsQ0FBQ0EsS0FBVDtBQUNBQyxlQUFPLENBQUNBLElBQVI7QUFDQUMsZUFBTyxDQUFDQSxJQUFSOztBQUVBLFlBQUlSLE1BQU0zQixLQUFLTCxHQUFMLENBQVNLLEtBQUtvQyxJQUFMLENBQVUsQ0FBQ0YsT0FBT0QsS0FBUixJQUFpQkUsSUFBM0IsQ0FBVCxFQUEyQyxDQUEzQyxDQUFWO0FBQ0EsWUFBSUUsTUFBTSxDQUFWO0FBQ0EsWUFBSUwsUUFBUSxJQUFJTSxLQUFKLENBQVVYLEdBQVYsQ0FBWjs7QUFFQSxlQUFPVSxNQUFNVixHQUFiLEVBQWtCO0FBQ2RLLGtCQUFNSyxLQUFOLElBQWVKLEtBQWY7QUFDQUEscUJBQVNFLElBQVQ7QUFDSDs7QUFFRCxlQUFPSCxLQUFQO0FBQ0g7QUF6SFksQ0FBakIiLCJmaWxlIjoiYmFzaWMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICAgICMjIEJhc2ljc1xuKi9cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIC8vIOi/lOWbnuS4gOS4qumaj+acuueahOW4g+WwlOWAvOOAglxuICAgIGJvb2xlYW46IGZ1bmN0aW9uKG1pbiwgbWF4LCBjdXIpIHtcbiAgICAgICAgaWYgKGN1ciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBtaW4gPSB0eXBlb2YgbWluICE9PSAndW5kZWZpbmVkJyAmJiAhaXNOYU4obWluKSA/IHBhcnNlSW50KG1pbiwgMTApIDogMVxuICAgICAgICAgICAgbWF4ID0gdHlwZW9mIG1heCAhPT0gJ3VuZGVmaW5lZCcgJiYgIWlzTmFOKG1heCkgPyBwYXJzZUludChtYXgsIDEwKSA6IDFcbiAgICAgICAgICAgIHJldHVybiBNYXRoLnJhbmRvbSgpID4gMS4wIC8gKG1pbiArIG1heCkgKiBtaW4gPyAhY3VyIDogY3VyXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gTWF0aC5yYW5kb20oKSA+PSAwLjVcbiAgICB9LFxuICAgIGJvb2w6IGZ1bmN0aW9uKG1pbiwgbWF4LCBjdXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYm9vbGVhbihtaW4sIG1heCwgY3VyKVxuICAgIH0sXG4gICAgLy8g6L+U5Zue5LiA5Liq6ZqP5py655qE6Ieq54S25pWw77yI5aSn5LqO562J5LqOIDAg55qE5pW05pWw77yJ44CCXG4gICAgbmF0dXJhbDogZnVuY3Rpb24obWluLCBtYXgpIHtcbiAgICAgICAgbWluID0gdHlwZW9mIG1pbiAhPT0gJ3VuZGVmaW5lZCcgPyBwYXJzZUludChtaW4sIDEwKSA6IDBcbiAgICAgICAgbWF4ID0gdHlwZW9mIG1heCAhPT0gJ3VuZGVmaW5lZCcgPyBwYXJzZUludChtYXgsIDEwKSA6IDkwMDcxOTkyNTQ3NDA5OTIgLy8gMl41M1xuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbikpICsgbWluXG4gICAgfSxcbiAgICAvLyDov5Tlm57kuIDkuKrpmo/mnLrnmoTmlbTmlbDjgIJcbiAgICBpbnRlZ2VyOiBmdW5jdGlvbihtaW4sIG1heCkge1xuICAgICAgICBtaW4gPSB0eXBlb2YgbWluICE9PSAndW5kZWZpbmVkJyA/IHBhcnNlSW50KG1pbiwgMTApIDogLTkwMDcxOTkyNTQ3NDA5OTJcbiAgICAgICAgbWF4ID0gdHlwZW9mIG1heCAhPT0gJ3VuZGVmaW5lZCcgPyBwYXJzZUludChtYXgsIDEwKSA6IDkwMDcxOTkyNTQ3NDA5OTIgLy8gMl41M1xuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbikpICsgbWluXG4gICAgfSxcbiAgICBpbnQ6IGZ1bmN0aW9uKG1pbiwgbWF4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmludGVnZXIobWluLCBtYXgpXG4gICAgfSxcbiAgICAvLyDov5Tlm57kuIDkuKrpmo/mnLrnmoTmta7ngrnmlbDjgIJcbiAgICBmbG9hdDogZnVuY3Rpb24obWluLCBtYXgsIGRtaW4sIGRtYXgpIHtcbiAgICAgICAgZG1pbiA9IGRtaW4gPT09IHVuZGVmaW5lZCA/IDAgOiBkbWluXG4gICAgICAgIGRtaW4gPSBNYXRoLm1heChNYXRoLm1pbihkbWluLCAxNyksIDApXG4gICAgICAgIGRtYXggPSBkbWF4ID09PSB1bmRlZmluZWQgPyAxNyA6IGRtYXhcbiAgICAgICAgZG1heCA9IE1hdGgubWF4KE1hdGgubWluKGRtYXgsIDE3KSwgMClcbiAgICAgICAgdmFyIHJldCA9IHRoaXMuaW50ZWdlcihtaW4sIG1heCkgKyAnLic7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBkY291bnQgPSB0aGlzLm5hdHVyYWwoZG1pbiwgZG1heCk7IGkgPCBkY291bnQ7IGkrKykge1xuICAgICAgICAgICAgcmV0ICs9IChcbiAgICAgICAgICAgICAgICAvLyDmnIDlkI7kuIDkvY3kuI3og73kuLogMO+8muWmguaenOacgOWQjuS4gOS9jeS4uiAw77yM5Lya6KKrIEpTIOW8leaTjuW/veeVpeaOieOAglxuICAgICAgICAgICAgICAgIChpIDwgZGNvdW50IC0gMSkgPyB0aGlzLmNoYXJhY3RlcignbnVtYmVyJykgOiB0aGlzLmNoYXJhY3RlcignMTIzNDU2Nzg5JylcbiAgICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChyZXQsIDEwKVxuICAgIH0sXG4gICAgLy8g6L+U5Zue5LiA5Liq6ZqP5py65a2X56ym44CCXG4gICAgY2hhcmFjdGVyOiBmdW5jdGlvbihwb29sKSB7XG4gICAgICAgIHZhciBwb29scyA9IHtcbiAgICAgICAgICAgIGxvd2VyOiAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonLFxuICAgICAgICAgICAgdXBwZXI6ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicsXG4gICAgICAgICAgICBudW1iZXI6ICcwMTIzNDU2Nzg5JyxcbiAgICAgICAgICAgIHN5bWJvbDogJyFAIyQlXiYqKClbXSdcbiAgICAgICAgfVxuICAgICAgICBwb29scy5hbHBoYSA9IHBvb2xzLmxvd2VyICsgcG9vbHMudXBwZXJcbiAgICAgICAgcG9vbHNbJ3VuZGVmaW5lZCddID0gcG9vbHMubG93ZXIgKyBwb29scy51cHBlciArIHBvb2xzLm51bWJlciArIHBvb2xzLnN5bWJvbFxuXG4gICAgICAgIHBvb2wgPSBwb29sc1soJycgKyBwb29sKS50b0xvd2VyQ2FzZSgpXSB8fCBwb29sXG4gICAgICAgIHJldHVybiBwb29sLmNoYXJBdCh0aGlzLm5hdHVyYWwoMCwgcG9vbC5sZW5ndGggLSAxKSlcbiAgICB9LFxuICAgIGNoYXI6IGZ1bmN0aW9uKHBvb2wpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhcmFjdGVyKHBvb2wpXG4gICAgfSxcbiAgICAvLyDov5Tlm57kuIDkuKrpmo/mnLrlrZfnrKbkuLLjgIJcbiAgICBzdHJpbmc6IGZ1bmN0aW9uKHBvb2wsIG1pbiwgbWF4KSB7XG4gICAgICAgIHZhciBsZW5cbiAgICAgICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjYXNlIDA6IC8vICgpXG4gICAgICAgICAgICAgICAgbGVuID0gdGhpcy5uYXR1cmFsKDMsIDcpXG4gICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgIGNhc2UgMTogLy8gKCBsZW5ndGggKVxuICAgICAgICAgICAgICAgIGxlbiA9IHBvb2xcbiAgICAgICAgICAgICAgICBwb29sID0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAvLyAoIHBvb2wsIGxlbmd0aCApXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGxlbiA9IG1pblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vICggbWluLCBtYXggKVxuICAgICAgICAgICAgICAgICAgICBsZW4gPSB0aGlzLm5hdHVyYWwocG9vbCwgbWluKVxuICAgICAgICAgICAgICAgICAgICBwb29sID0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgbGVuID0gdGhpcy5uYXR1cmFsKG1pbiwgbWF4KVxuICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cblxuICAgICAgICB2YXIgdGV4dCA9ICcnXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIHRleHQgKz0gdGhpcy5jaGFyYWN0ZXIocG9vbClcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0ZXh0XG4gICAgfSxcbiAgICBzdHI6IGZ1bmN0aW9uKCAvKnBvb2wsIG1pbiwgbWF4Ki8gKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0cmluZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG4gICAgfSxcbiAgICAvLyDov5Tlm57kuIDkuKrmlbTlnovmlbDnu4TjgIJcbiAgICByYW5nZTogZnVuY3Rpb24oc3RhcnQsIHN0b3AsIHN0ZXApIHtcbiAgICAgICAgLy8gcmFuZ2UoIHN0b3AgKVxuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgICAgICBzdG9wID0gc3RhcnQgfHwgMDtcbiAgICAgICAgICAgIHN0YXJ0ID0gMDtcbiAgICAgICAgfVxuICAgICAgICAvLyByYW5nZSggc3RhcnQsIHN0b3AgKVxuICAgICAgICBzdGVwID0gYXJndW1lbnRzWzJdIHx8IDE7XG5cbiAgICAgICAgc3RhcnQgPSArc3RhcnRcbiAgICAgICAgc3RvcCA9ICtzdG9wXG4gICAgICAgIHN0ZXAgPSArc3RlcFxuXG4gICAgICAgIHZhciBsZW4gPSBNYXRoLm1heChNYXRoLmNlaWwoKHN0b3AgLSBzdGFydCkgLyBzdGVwKSwgMCk7XG4gICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICB2YXIgcmFuZ2UgPSBuZXcgQXJyYXkobGVuKTtcblxuICAgICAgICB3aGlsZSAoaWR4IDwgbGVuKSB7XG4gICAgICAgICAgICByYW5nZVtpZHgrK10gPSBzdGFydDtcbiAgICAgICAgICAgIHN0YXJ0ICs9IHN0ZXA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmFuZ2U7XG4gICAgfVxufSJdfQ==